# barcode_match

## Description
Match the scATAC-seq cell barcode to GEX cell barcode for 10x multiome
datasets. The scRNA-seq and scATAC-seq data from the same cell have
different cell barcodes, and so they cannot easily be associated with
one another. This program converts the scATAC-seq barcode to the
respective scRNA-seq barcode from the same cell so that data can be
associated. This is done with the help of the line-matched cell barcode
inclusion files that can be found here. 

NOTE: This program can be used with either SAM/BAM files or delimited
files (such as a fragments.tsv file). Read the `-a`, `-d`, `-c`, and `t`
options to determine the appropriate usage.

## Parameters
```
barcode_match [options]
  -a aligned SAM/BAM file or TSV/CSV file [required]
  -g GEX barcode list file [required]
  -b ATAC barcode list file [required]
  -o out file name [required]
  -d split delimeter; Ignored if -t is provided. [default: ":"]
  -c barcode field column; Ignored if -t is provided. [default: 7 (0 based)]
  -t barcode tag in SAM file [default ""]
  -s suffix to add to output barcode [default: ""]
  -v verbose [default: false];
```

`-a` An aligned SAM/BAM file or a delimited file. If the file name ends
with a `.sam` or `.bam` it is treated as a such, else it is treated as
a delimited file. See options `-d`, `-c`, and `t` for parsing the cell
barcode depending on file type. [Required].  

`-g`: 10x gene-expression barcode inclusion list. [Required]

`-b`: line matched 10x ATAC-seq barcode inclusion list. [Required] 

`-o`: Output file prefix to name out files. [Required].

 `-d`: The use of this parameter varies depending on the input file
type. For SAM/BAM files, it is used when the cell barcode is encoded 
as a part of the query name (QNAME field). Split the QNAME by the 
specified delimiter. For delimited files, this is the delimiter used
to split the columns. Use "t" for tab. [Default: ":"]. 

`-c`: The use of this parameter varies depending on the input file type.
For SAM/BAM files, it is used when the cell barcode is encoded as a part
of the query name (QNAME field). Split the QNAME by the delimiter
specified by `-d` and take the barcode as the value in the columns
specified by `-c` (0 based). For example, reads that are generated by
Illumina sequencers have a FASTQ names that have 7 fields that are
separated by a ":", and the cell barcode is typically added as the 8th
field. For delimited files, it is the 0 based column of the cell
barcode. [Default: 7].   

`-t`: Used when the cell barcode is present in a SAM entry as a tag. For
example, SAM files generated by CellRanger encodes the error correct
cell barcode in the `CB` tag. If this parameter is set, `-d` and `-c`
flags are ignored. [Default: none]

`-s` Suffix to add to the end of the matched barcode. This parameter is
useful to make the barcode format consistent with tools that suffix the
barcodes with a `-1`. [Default: none].

`-v`: Verbosity flag. Set the flag to print progress and statistics to
standard error. [Default: false].

## Input and output file description
### Description of input files
Either a SAM/BAM file or a delimited file (such as a tab-delimited
fragments file).

### Description of output files
A file in the same format of the input file. The output file just has
the cell barcode replaced, all else remains the same. If a cell barcode
in the input file does not occur in the barcode inclusion list, that
entry is skipped and will not be written to the output file. Therefore,
the output file can contain fewer lines than the input file.  The name
of the output file is given by the `-o` parameter. 
